╔═══════════════════════════════════════════════════════════════════════════════╗
║                   📊 Wandb监控参数速查表 - 联合训练模式                         ║
╚═══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│ 🎯 优先级1：核心三角指标（必看！）                                            │
├─────────────────────────────────────────────────────────────────────────────┤
│ 指标                        │ 含义            │ 期望趋势    │ 典型值范围     │
│─────────────────────────────┼─────────────────┼─────────────┼────────────────│
│ batch/loss_total            │ 总损失          │ ⬇️ 下降     │ 0.8→0.3        │
│ batch/loss_ratio ⭐⭐⭐      │ 静态/动态比值   │ ➡️ 稳定     │ 0.7-1.0        │
│ batch/static_contribution⭐ │ 静态实际占比    │ ➡️ ~50%     │ 45%-55%        │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 🔬 优先级2：损失分解（调试用）                                                │
├─────────────────────────────────────────────────────────────────────────────┤
│ 指标                        │ 含义                  │ 期望趋势    │ 初始→收敛  │
│─────────────────────────────┼───────────────────────┼─────────────┼────────────│
│ batch/loss_static           │ 静态重建损失(1帧)     │ ⬇️ 下降     │ 0.6→0.3    │
│ batch/loss_dynamic          │ 动态总损失(4帧)       │ ⬇️ 下降     │ 0.8→0.4    │
│ batch/loss_recon ⭐         │ 动态重建(前3帧)       │ ⬇️ 下降     │ 0.5→0.2    │
│ batch/loss_pred ⭐          │ 预测损失(第4帧)       │ ⬇️ 下降     │ 0.3→0.1    │
│ batch/weighted_static       │ 加权静态 (α×静态)     │ ⬇️ 下降     │ 0.3→0.15   │
│ batch/weighted_dynamic      │ 加权动态 (β×动态)     │ ⬇️ 下降     │ 0.4→0.20   │
│                                                                               │
│ 🔍 验证公式: loss_dynamic = loss_recon + loss_pred (应严格相等)              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ ⚙️ 优先级3：训练控制（监控）                                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│ 指标                        │ 含义            │ 期望趋势            │ 范围       │
│─────────────────────────────┼─────────────────┼─────────────────────┼────────────│
│ batch/lr                    │ 学习率          │ 📈📉 先升后降       │ 6e-5→1e-3  │
│ batch/alpha                 │ 静态权重        │ ➡️ 常量 0.5         │ 0.5        │
│ batch/beta                  │ 动态权重        │ ➡️ 常量 0.5         │ 0.5        │
│ batch/dynamic_contribution  │ 动态实际占比    │ ➡️ ~50%             │ 45%-55%    │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 📈 Epoch级别汇总（每轮统计）                                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│ epoch/train_loss                    │ Epoch平均总损失                        │
│ epoch/loss_static                   │ Epoch平均静态损失                      │
│ epoch/loss_dynamic                  │ Epoch平均动态损失                      │
│ epoch/loss_ratio                    │ Epoch平均比值                          │
│ epoch/actual_static_contribution⭐  │ Epoch静态实际占比（调参依据）           │
│ epoch/actual_dynamic_contribution⭐ │ Epoch动态实际占比（调参依据）           │
│ epoch/best_loss_so_far              │ 历史最佳损失                           │
└─────────────────────────────────────────────────────────────────────────────┘

╔═══════════════════════════════════════════════════════════════════════════════╗
║                          ⚠️ 异常模式识别                                      ║
╚═══════════════════════════════════════════════════════════════════════════════╝

🔴 危险信号（立即停止训练）
   ├─ loss = NaN 或 Inf              → 梯度爆炸，降低学习率
   ├─ loss突然大幅上升(>2倍)         → 检查数据或学习率
   └─ loss完全不下降(>20 epochs)     → 检查代码逻辑

🟡 警告信号（需要调整参数）
   ├─ loss_ratio > 1.5              → 动态太容易，增加β权重
   ├─ loss_ratio < 0.5              → 静态太容易，增加α权重
   ├─ static_contribution > 65%     → 静态占比过高，调整α↓或β↑
   ├─ static_contribution < 35%     → 动态占比过高，调整α↑或β↓
   └─ loss震荡剧烈                  → 学习率过高

🟢 正常信号（训练健康）
   ├─ loss平滑下降                  ✅
   ├─ loss_ratio在0.7-1.0稳定       ✅
   ├─ contribution在45%-55%         ✅
   └─ 无NaN/Inf                     ✅

╔═══════════════════════════════════════════════════════════════════════════════╗
║                      🎯 快速测试5轮检查清单                                    ║
╚═══════════════════════════════════════════════════════════════════════════════╝

Epoch 0 (初始化) ✓
  □ loss_total在0.8-1.2范围
  □ loss_static和loss_dynamic相差不大(<30%)
  □ static_contribution在40%-60%

Epoch 1-2 (启动学习) ✓
  □ loss_total开始下降(降幅5-10%)
  □ loss_ratio开始稳定
  □ lr从6e-5逐渐上升

Epoch 3-4 (趋势确认) ✓
  □ loss_total持续下降
  □ loss_static和loss_dynamic都在下降
  □ contribution稳定在期望范围
  □ 无NaN/Inf错误

╔═══════════════════════════════════════════════════════════════════════════════╗
║                        📊 参数调整速查表                                       ║
╚═══════════════════════════════════════════════════════════════════════════════╝

观察到的现象                           │ 当前参数  │ 建议调整
──────────────────────────────────────┼───────────┼─────────────────
loss_ratio > 1.5 (动态太容易)         │ α=0.5 β=0.5│ α=0.3 β=0.7
loss_ratio < 0.5 (静态太容易)         │ α=0.5 β=0.5│ α=0.7 β=0.3
static_contribution > 65%              │ α=0.5 β=0.5│ α=0.3 β=0.7
static_contribution < 35%              │ α=0.5 β=0.5│ α=0.7 β=0.3
两个loss都不下降                      │ lr=1e-3    │ lr=5e-4或更低
loss震荡剧烈                          │ lr=1e-3    │ lr=5e-4
loss下降太慢                          │ lr=1e-3    │ lr=2e-3

╔═══════════════════════════════════════════════════════════════════════════════╗
║                          🎨 Wandb可视化建议                                   ║
╚═══════════════════════════════════════════════════════════════════════════════╝

推荐面板布局：

面板1: 总体趋势
  ├─ batch/loss_total (主曲线)
  ├─ epoch/train_loss (辅助)
  └─ epoch/best_loss_so_far (参考线)

面板2: 损失分解
  ├─ batch/loss_static
  ├─ batch/loss_dynamic
  └─ batch/loss_ratio (第二坐标轴)

面板3: 贡献度监控 ⭐
  ├─ batch/static_contribution
  ├─ batch/dynamic_contribution
  ├─ 参考线: y=0.5 (期望值)
  └─ 参考区间: [0.45, 0.55] (合理范围)

面板4: 学习率调度
  └─ batch/lr

面板5: 动态损失分解 ⭐ (新增)
  ├─ batch/loss_dynamic (总动态损失 - 粗线)
  ├─ batch/loss_recon   (重建损失 - 前3帧)
  ├─ batch/loss_pred    (预测损失 - 第4帧)
  └─ 验证: loss_recon + loss_pred 应与 loss_dynamic 重合

╔═══════════════════════════════════════════════════════════════════════════════╗
║                            💡 实战技巧                                         ║
╚═══════════════════════════════════════════════════════════════════════════════╝

1. 先看三角指标：loss_total ⬇️, loss_ratio ➡️, contribution ➡️50%
2. 如果loss_ratio异常，立即调整α和β
3. 用快速测试(5 epochs)验证参数，再开始完整训练
4. contribution比loss_ratio更能反映实际训练平衡性
5. Epoch级别的actual_contribution是最终调参依据

记住：Loss要下降，Ratio要稳定，Contribution要平衡！

════════════════════════════════════════════════════════════════════════════════
创建日期: 2025-10-24
适用版本: PhysioTouch Stage1 联合训练
════════════════════════════════════════════════════════════════════════════════
